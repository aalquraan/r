<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ˜ˆ ØµÙØ­Ø© Ø§Ù„Ù…Ù‚Ù€Ø§Ù‡ÙØ±Ø© â€“ Ø±Ø§Ù†ÙŠØ§ØŒ Ø¬Ø§Ù‡Ø²Ø©ØŸ ğŸ‘</title>
  <style>
    :root{
      --bg1:#18070a; --bg2:#1e0b0f; --pulse:#ff2b53; --accent:#ff8a00; --text:#f8fafc; --muted:#cbd5e1;
      --glass:rgba(255,255,255,.08); --border:rgba(255,255,255,.15)
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;min-height:100dvh;display:grid;place-items:center;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Noto Kufi Arabic","Noto Sans Arabic";background:
      radial-gradient(140% 120% at 70% 0%, #2a0e12 0%, var(--bg2) 45%, var(--bg1) 100%),
      repeating-linear-gradient(45deg, rgba(255,255,255,.03) 0 2px, transparent 2px 6px);
      color:var(--text);overflow:hidden}

    .pulse{position:fixed;inset:-60vmax;background:radial-gradient(closest-side, rgba(255,43,83,.35), transparent 65%);filter:blur(40px);animation:pulse 2.2s ease-in-out infinite;pointer-events:none}
    @keyframes pulse{50%{transform:scale(1.06);opacity:.85}}

    .rain{position:fixed;inset:0;pointer-events:none;z-index:1}
    .drop{position:absolute;font-size:clamp(18px,1.5vw,28px);animation:fall linear forwards;opacity:.9}
    @keyframes fall{to{transform:translateY(110vh) rotate(20deg);opacity:.3}}

    .wrap{width:min(1080px,94vw);position:relative;z-index:2;display:grid;gap:12px}

    header{display:grid;gap:10px;place-items:center;text-align:center}
    h1{margin:0;font-size:clamp(26px,2.4vw,40px);text-shadow:0 6px 30px rgba(255,43,83,.35)}
    .sub{color:var(--muted)}
    .shock{display:inline-block;transform-origin:center;animation:shake 1.2s ease-in-out infinite}
    @keyframes shake{10%,90%{transform:translateX(-2px) rotate(-1deg)}20%,80%{transform:translateX(2px) rotate(1deg)}30%,50%,70%{transform:translateX(-6px)}40%,60%{transform:translateX(6px)}}

    .banner{display:flex;gap:.5rem;align-items:center;justify-content:center;margin-top:2px}
    .pill{display:inline-flex;align-items:center;gap:.45rem;padding:.45rem .8rem;border-radius:999px;background:rgba(255,43,83,.16);border:1px solid rgba(255,43,83,.35)}

    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px;margin-top:6px}
    .col-4{grid-column:span 4}.col-6{grid-column:span 6}.col-8{grid-column:span 8}.col-12{grid-column:1/-1}
    @media (max-width:980px){.col-8,.col-6,.col-4{grid-column:1/-1}}

    .card{background:var(--glass);backdrop-filter:blur(10px);border:1px solid var(--border);border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .head{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--border)}
    .content{padding:12px 14px}

    .btn{cursor:pointer;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text);padding:.7rem 1rem;border-radius:12px;font-weight:900;transition:transform .12s ease, filter .2s ease}
    .btn:active{transform:translateY(1px)}
    .btn.primary{background:linear-gradient(135deg, rgba(255,43,83,.35), rgba(255,138,0,.25));border-color:rgba(255,43,83,.55)}
    .btn.ghost{background:rgba(255,255,255,.04)}

    .msgs{display:grid;gap:8px}
    .bubble{display:flex;align-items:center;gap:.6rem;padding:.6rem .8rem;border-radius:14px;background:rgba(255,255,255,.06);border:1px dashed rgba(255,255,255,.22)}

    .timer{font-variant-numeric:tabular-nums;font-weight:900;font-size:clamp(20px,2.3vw,28px)}

    .wheelWrap{display:grid;gap:10px;place-items:center}
    .wheel{position:relative;width:260px;height:260px;border-radius:50%;border:2px solid rgba(255,255,255,.3);overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.4)}
    .wheel canvas{width:100%;height:100%}
    .pointer{position:absolute;top:-8px;left:50%;transform:translateX(-50%);width:0;height:0;border-left:10px solid transparent;border-right:10px solid transparent;border-bottom:18px solid #fff}

    .runner{position:relative}
    .runner .escape{position:relative}

    .pledge{display:grid;gap:8px}
    input, textarea{width:100%;padding:.7rem 1rem;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text)}
  </style>
</head>
<body>
  <div class="pulse"></div>
  <div id="rain" class="rain"></div>

  <div class="wrap">
    <header>
      <h1 class="shock">Ø±Ø§Ù†ÙŠØ§â€¦ Ø®ÙŠÙ‘Ø¨ØªÙŠ Ø£Ù…Ù„ÙŠ <span title=":)">ğŸ‘</span></h1>
      <p class="sub">Ù…ÙˆØ¹Ø¯Ùƒ Ù…Ø±Ù‘Ù ÙˆÙ…Ø§ Ø®Ù„Ù‘ØµØªÙŠ Ø§Ù„Ø®Ø·Ø©. Ø­Ø§Ù† ÙˆÙ‚Øª Ø§Ù„Ù…Ù‚Ù€Ø§Ù‡ÙØ±Ø© Ø§Ù„Ù„Ø·ÙŠÙØ© Ø¨Ø³ Ø§Ù„Ù…Ø²Ø¹Ø¬Ø© ğŸ˜ˆğŸ‘</p>
      <div class="banner">
        <span class="pill">ÙƒÙ„ Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© = Ù…Ø²ÙŠØ¯ Ù…Ù† <strong>ğŸ‘</strong></span>
        <span class="pill">Ø§Ù„ØªØ²Ø§Ù…Ùƒ Ø§Ù„Ø¢Ù† ÙŠØ±Ø¬Ù‘Ø¹Ùƒ Ù„Ù„Ø®Ø·Ø© ÙÙˆØ±Ù‹Ø§</span>
      </div>
    </header>

    <section class="grid">
      <div class="card col-8">
        <div class="head"><strong>Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ù‚Ù€Ø§Ù‡ÙØ±Ø©</strong><small>ØªØªØ¨Ø¯Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§</small></div>
        <div class="content">
          <div id="msgs" class="msgs"></div>
          <div style="display:flex;align-items:center;gap:10px;margin-top:8px">
            <button id="moreSting" class="btn primary">ğŸ˜ˆ Ø¯ÙØ´Ø© Ø£Ù‚ÙˆÙ‰ ğŸ‘</button>
            <div style="margin-inline-start:auto" class="timer">Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø®Ø·Ø© Ø®Ù„Ø§Ù„ <span id="backIn">30</span> Ø«Ø§Ù†ÙŠØ© ğŸ‘</div>
          </div>
        </div>
      </div>

      <div class="card col-4">
        <div class="head"><strong>ğŸ¡ Ø¹Ø¬Ù„Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª</strong><small>Ù„ÙÙ‘ÙŠÙ‡Ø§ Ø¥Ø°Ø§ ØªØ¬Ø±Ø£ØªÙŠ ğŸ‘</small></div>
        <div class="content wheelWrap">
          <div class="wheel" aria-label="Ø¹Ø¬Ù„Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª">
            <canvas id="wheel"></canvas>
            <div class="pointer"></div>
          </div>
          <div style="display:flex;gap:8px;align-items:center">
            <button id="spin" class="btn ghost">ğŸ² Ù„ÙÙ‘ÙŠ Ø§Ù„Ø¹Ø¬Ù„Ø©</button>
            <span id="spinRes" class="sub">â€”</span>
          </div>
        </div>
      </div>

      <div class="card col-12">
        <div class="head"><strong>Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¥Ù„ÙŠÙƒÙ</strong><small>ØªØ¹Ù‡Ø¯/Ø±Ø¬ÙˆØ¹/ØªØ­Ø¯Ù‘Ù</small></div>
        <div class="content" style="display:grid;gap:10px">
          <div class="pledge">
            <label>âœï¸ Ø§ÙƒØªØ¨ÙŠ ØªØ¹Ù‡Ø¯Ùƒ Ø§Ù„Ø¢Ù† (Ø¥Ø³Ù…Ùƒ + 30 Ø¯Ù‚ÙŠÙ‚Ø© ØªØ±ÙƒÙŠØ²):</label>
            <div style="display:grid;grid-template-columns:1fr auto;gap:8px">
              <input id="pledgeText" placeholder="Ø£Ù†Ø§ Ø±Ø§Ù†ÙŠØ§ Ø£ØªØ¹Ù‡Ø¯ Ø¨Ù€ 30 Ø¯Ù‚ÙŠÙ‚Ø© ØªØ±ÙƒÙŠØ² Ø§Ù„Ø¢Ù† ğŸ‘" />
              <button id="commit" class="btn primary">ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ¹Ù‡Ø¯ ğŸ‘</button>
            </div>
          </div>
          <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center">
            <div class="runner">
              <button id="sorry" class="btn">ğŸ™„ Ø¢Ø³ÙØ©ØŒ Ø§Ø±Ø¬Ø¹ÙŠ Ù„Ù„Ø®Ø·Ø©</button>
            </div>
            <button id="harder" class="btn primary escape">Ø£ØµØ¹Ù‘Ø¨Ù‡Ø§ Ø£ÙƒØ«Ø± ğŸ‘</button>
            <button id="miniChallenge" class="btn ghost">ØªØ­Ø¯Ù‘ÙŠ Ø³Ø±ÙŠØ¹: Ø§ÙƒÙ…Ù„ÙŠ ÙÙ‚Ø±Ø© Ø§Ù„Ø¢Ù† ğŸ‘</button>
            <div style="margin-inline-start:auto">
              <button id="backNow" class="btn primary">â†©ï¸ Ø§Ø±Ø¬Ø¹ÙŠ Ù„Ù„Ø®Ø·Ø© Ø§Ù„Ø¢Ù†</button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <audio id="buzz" preload="auto"><source src="data:audio/mp3;base64,//uQZAAAAAAAAAAAAAAAAAAAA..." type="audio/mp3"></audio>

  <script>
    const qs = new URLSearchParams(location.search);
    const total = Number(qs.get('total')||0);
    const done = Number(qs.get('done')||0);

    const rain = document.getElementById('rain');
    function emojiRain(char='ğŸ‘', amount=14){
      for(let i=0;i<amount;i++){
        const d=document.createElement('div');
        d.className='drop'; d.style.left=(Math.random()*100)+'vw'; d.style.top='-10vh'; d.style.animationDuration=(1.4+Math.random()*1.6)+'s';
        d.textContent=char; rain.appendChild(d); setTimeout(()=>d.remove(),2600);
      }
    }
    addEventListener('click',()=>emojiRain('ğŸ‘', 10));
    setInterval(()=>emojiRain('ğŸ‘', 8), 1200);

    const buzz=document.getElementById('buzz');
    function vibrate(){ navigator.vibrate?.(120); try{ buzz.currentTime=0; buzz.play(); }catch{} }
    vibrate();

    const msgs = document.getElementById('msgs');
    const poolSoft = [
      `Ø¬Ø¯ØŸ Ù‡Ø°Ø§ Ø¥Ù†Ø¬Ø§Ø²ÙƒØŸ <b>ğŸ‘</b>`,
      `Ø§Ù„ÙˆÙ‚Øª ØºØ§Ù„ÙŠâ€¦ Ø§Ù„ØªØ³ÙˆÙŠÙ Ø£Ø±Ø®Øµ Ø´ÙŠ <b>ğŸ‘</b>`,
      `Ø­ØªÙ‰ Ø§Ù„Ù…Ù†Ø¨Ù‘Ù‡ ØªØ¹Ø¨ ÙˆÙ‡Ùˆ Ø¨ØµØ­ÙŠ ÙÙŠÙƒ <b>ğŸ‘</b>`,
      `ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© Ø§Ù„Ø¢Ù† Ø£Ø­Ø³Ù† Ù…Ù† 10 Ø¨ÙƒØ±Ø© <b>ğŸ‘</b>`,
    ];
    const poolHard = [
      `Ù„Ùˆ ÙƒØ§Ù† ÙÙŠ Ù…Ù†Ø§ÙØ³Ø© ØªØ£Ø¬ÙŠÙ„â€¦ Ø¨ØªÙÙˆØ²ÙŠ Ø°Ù‡Ø¨ <b>ğŸ‘ğŸ‘</b>`,
      `Ø§Ù„Ù‚Ù‡ÙˆØ© Ù…Ø´ Ø¨ØªØ¯Ø±Ø³ Ø¹Ù†Ùƒ â€” ÙˆÙ‚ØªÙƒ ÙŠØ·ÙŠØ± <b>ğŸ‘</b>`,
      `Ø®Ø§Ù„ÙÙŠ Ø§Ù„ØªØ³ÙˆÙŠÙ 25 Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ¨Ø³ <b>ğŸ‘</b>`,
      `Ø§Ù†Ù‚Ø·Ø§Ø¹ 30 Ø¯Ù‚ÙŠÙ‚Ø© = Ø¥Ù†Ù‚Ø§Ø° Ø§Ù„ÙŠÙˆÙ… <b>ğŸ‘ğŸ‘</b>`,
    ];
    let harsh=false, idx=0;
    function nextMsg(){
      const m=document.createElement('div'); m.className='bubble'; m.innerHTML=(harsh?poolHard:poolSoft)[idx%(harsh?poolHard.length:poolSoft.length)]; idx++; msgs.prepend(m); if(msgs.childElementCount>6) msgs.lastElementChild.remove(); vibrate(); }
    setInterval(nextMsg, 2500); nextMsg();
    document.getElementById('moreSting').addEventListener('click',()=>{ harsh=true; nextMsg(); emojiRain('ğŸ‘',16) });

    const backIn = document.getElementById('backIn');
    let s=30; const countdown=setInterval(()=>{ s--; backIn.textContent = s + 'ğŸ‘'; if(s<=0){ clearInterval(countdown); goBack(); } },1000);

    function goBack(){ location.href = 'plan.html'; }
    document.getElementById('backNow').addEventListener('click', goBack);

    const sorry = document.getElementById('sorry');
    sorry.addEventListener('mousemove',(e)=>{
      const r=sorry.getBoundingClientRect();
      const dx = (e.clientX - (r.left+r.width/2))/r.width;
      const dy = (e.clientY - (r.top+r.height/2))/r.height;
      sorry.style.transform = `translate(${dx*18}px, ${dy*12}px)`;
    });
    sorry.addEventListener('mouseleave',()=>{ sorry.style.transform='translate(0,0)'; });
    sorry.addEventListener('click',()=>{ nextMsg(); emojiRain('ğŸ‘',20); });

    document.getElementById('harder').addEventListener('click',()=>{
      harsh=true; for(let i=0;i<3;i++) nextMsg(); emojiRain('ğŸ‘',26);
    });

    const pledgeText=document.getElementById('pledgeText');
    document.getElementById('commit').addEventListener('click',()=>{
      const v=pledgeText.value.trim();
      if(v.length<8){ alert('Ù…Ø´ Ù‚Ø¯Ù‡Ø§ ğŸ‘ Ø§ÙƒØªØ¨ ØªØ¹Ù‡Ø¯ ÙˆØ§Ø¶Ø­'); vibrate(); return }
      localStorage.setItem('rania_pledge', JSON.stringify({t:Date.now(), text:v}));
      alert('ØªÙ… Ø§Ù„ØªØ¹Ù‡Ù‘Ø¯. Ø¨Ù†Ø±Ø¬Ø¹Ùƒ Ù„Ù„Ø®Ø·Ø© Ø§Ù„Ø¢Ù† ğŸ‘'); goBack();
    });

    const wheel=document.getElementById('wheel'); const wctx=wheel.getContext('2d');
    const punish=[
      '20 Ø¶ØºØ·Ø§Øª ğŸ¤¸â€â™€ï¸ ğŸ‘',
      'Ø§Ù†Ø³Ø®ÙŠ Ù‚Ø§Ù†ÙˆÙ† 5Ã— ğŸ“ ğŸ‘',
      'ÙƒÙˆØ¨ Ù…ÙŠ Ø§Ù„Ø¢Ù† ğŸ’§ ğŸ‘',
      'Ù…Ù„Ø®Øµ ÙÙ‚Ø±Ø© Ø¨ØµÙˆØª Ø¹Ø§Ù„ÙŠ ğŸ™ï¸ ğŸ‘',
      '5 Ø£Ø³Ø¦Ù„Ø© Ø³Ø±ÙŠØ¹Ø© â“ ğŸ‘',
      'Ù‚Ø±Ø§Ø¡Ø© 10 Ø¯ Ø²ÙŠØ§Ø¯Ø© ğŸ“– ğŸ‘',
    ];
    function drawWheel(angle=0){
      const R=wheel.width=wheel.height=520; const cx=R/2, cy=R/2, r=R/2-6; wctx.clearRect(0,0,R,R); wctx.save(); wctx.translate(cx,cy); wctx.rotate(angle);
      for(let i=0;i<punish.length;i++){
        const a1=(i/punish.length)*2*Math.PI, a2=((i+1)/punish.length)*2*Math.PI;
        wctx.beginPath(); wctx.moveTo(0,0); wctx.arc(0,0,r,a1,a2); wctx.closePath(); wctx.fillStyle = i%2? 'rgba(255,43,83,.35)':'rgba(255,138,0,.35)'; wctx.fill();
        wctx.strokeStyle='rgba(255,255,255,.2)'; wctx.stroke();
        wctx.save(); const mid=(a1+a2)/2; wctx.rotate(mid); wctx.fillStyle='#fff'; wctx.font='700 22px system-ui'; wctx.textAlign='center'; wctx.fillText(punish[i], r-150, 8); wctx.restore();
      }
      wctx.restore();
    }
    drawWheel();
    let spinAngle=0, spinning=false; const spinRes=document.getElementById('spinRes');
    document.getElementById('spin').addEventListener('click',()=>{
      if(spinning) return; spinning=true; spinRes.textContent='...'; emojiRain('ğŸ‘', 22);
      const extra = Math.random()*Math.PI*6 + Math.PI*6; const start=performance.now(); const dur=2700;
      (function anim(t){ const e=(t-start)/dur; if(e>=1){ spinAngle+=extra; spinning=false; drawWheel(spinAngle); const idx = punish.length - 1 - Math.floor(((spinAngle%(2*Math.PI))/(2*Math.PI))*punish.length)%punish.length; const res=punish[idx]; spinRes.textContent='Ù†ÙÙ‘Ø°ÙŠ Ø§Ù„Ø¢Ù†: '+res; vibrate(); return } const ease=1-Math.pow(1-e,3); drawWheel(spinAngle + extra*ease); requestAnimationFrame(anim); })(start);
    });

    document.getElementById('miniChallenge').addEventListener('click',()=>{
      alert('Ø§Ù„Ø¢Ù†: Ø§ÙØªØ­ÙŠ Ø§Ù„Ø®Ø·Ø© ÙˆØ§ÙƒÙ…Ù„ÙŠ ÙÙ‚Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ø®Ù„Ø§Ù„ 10 Ø¯Ù‚Ø§Ø¦Ù‚ ğŸ‘');
    });

    if(total && done && done<total){ nextMsg(); }
  </script>
</body>
</html>
